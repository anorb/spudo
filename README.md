# PluGo
PluGo helps build a Discord bot that utilizes [Go plugins](https://golang.org/pkg/plugin/) to add functionality. Built using [DiscordGo](https://github.com/bwmarrin/discordgo).

## Creating a bot
### Create a config
The config uses the [TOML](https://github.com/toml-lang/toml) format.
```toml
# Token generated by discord for your bot
LiveToken="SAKkj343jnNajw429Je"
# Prefix used to determine when a command is issued
CommandPrefix="!"
# Default channel for welcome back/timed messages to be sent in
ChannelID="5432188465698448"
# Time that must elapse before a user can issue another command (in seconds)
CooldownTimer=10
# Message that will be sent when a user tries to issue too many commands in a short time
CooldownMessage="You have used too many commands"
# Message bot will send when it conects or reconnects
WelcomeBackMessage="I'm back!"
# Message that will be sent when a user issues an invalid command
UnknownCommandMessage="Command is invalid"
# Directory where the .so plugins will be stored
PluginsDir="plugins"
```
### Create bot
```go
package main

import (
	"fmt"
	"log"
	"os"
	"os/signal"
	"syscall"
	"gitlab.com/anorb/plugo"
)

func main() {
	bot := plugo.NewBot()
	bot.Start()

	fmt.Println("Bot is now running.  Press CTRL-C to exit.")
	sc := make(chan os.Signal, 1)
	signal.Notify(sc, syscall.SIGINT, syscall.SIGTERM, os.Interrupt, os.Kill)
	<-sc

	if err := bot.Session.Close(); err != nil {
		log.Fatal("Error closing discord session" + err.Error())
	}
}
```

## Basic plugin
### Create the plugin
```go
package main

import "gitlab.com/anorb/plugo/pluginhandler"

func ping(args []string) interface{} {
	return "pong!"
}

func Register() interface{} {
	return pluginhandler.NewCommand("ping", ping).SetDescription("Returns ping on !pong command")
}
```
### Build the plugin
```sh
go build -buildmode=plugin ping.go
```
### Move ping.so to directory specified in your config
